# AWS LoginPort

AWS LoginPort는 Google Sheets와 연동하여 고객사 정보를 자동으로 불러오고, AWS 콘솔 로그인 자동화를 지원하는 Electron 기반 데스크탑 애플리케이션입니다.

## 주요 특징
- **Google Sheets 연동**: 서비스 계정 인증을 통해 스프레드시트에서 고객사 목록을 불러옵니다.
- **정확한 시트명 매칭**: 입력한 시트명과 정확히 일치하는 스프레드시트만 검색합니다.
- **명확한 에러 안내**: 인증 실패, 시트명 오류, 데이터 없음 등 상황별로 사용자에게 명확한 메시지를 제공합니다.
- **Electron 기반**: Windows 환경에서 독립 실행형 데스크탑 앱으로 동작합니다.
- **설정 및 인증 파일 자동 관리**: Google 인증 JSON 파일을 자동으로 패키징 및 추출하여 별도의 수동 복사가 필요 없습니다.
- **Express 웹 UI 제공**: 내장 웹 서버(app.js)를 통해 브라우저에서 고객사 목록 확인 및 AWS 콘솔 자동 로그인을 지원합니다.
- **Puppeteer 기반 브라우저 자동화**: OTP 입력 등 AWS MFA 자동화 및 브라우저 제어를 지원합니다.

## 설치 및 실행 방법

1. **Google Cloud 서비스 계정 및 인증 파일 준비**
   - Google Cloud Console에서 서비스 계정을 생성하고, `service-account.json` 인증 파일을 다운로드합니다.
   - 해당 파일을 프로젝트 루트에 위치시키세요.
   - 초기에 인증 파일을 넣지 않더라도 앱 설치 후에 인증 파일을 업로드해서 사용할 수 있습니다.

2. **의존성 설치**
   ```bash
   npm install
   ```

3. **개발 모드 실행**
   ```bash
   npm start
   ```

4. **프로덕션 빌드 (Windows 설치파일 생성)**
   ```bash
   npm run dist
   ```
   - 빌드 후 생성된 `dist/` 폴더에서 설치 파일(`.exe`)을 실행하여 앱을 설치할 수 있습니다.

## Google 인증 파일(asarUnpack 관련)
- `package.json`의 `asarUnpack` 옵션에 인증 JSON 파일이 포함되어 있으므로, 설치 시 자동으로 `resources` 폴더에 복사됩니다.
- 앱은 실행 시 해당 경로에서 인증 파일을 자동으로 탐색합니다.

## 주요 파일 설명
- `main.js` : Electron 메인 프로세스, 창 및 IPC 관리
- `app.js` : Express 기반 웹 서버. Google Sheets에서 불러온 고객사 목록을 웹 UI로 제공하며, Puppeteer를 통해 AWS 콘솔 자동 로그인 및 MFA 자동 입력 기능을 지원합니다. 내장 크롬 브라우저 경로 탐색, 캐시 관리, 포트 가용성 검사 등 서버 유틸리티 기능 포함
- `sheets_loader.js` : Google Sheets API 연동 및 데이터 로딩, 인증 파일 경로 자동 탐색
- `config.json` : 앱 설정 파일 (시트명 등)
- `service-account.json` : Google 서비스 계정 인증 파일 (개별 사용자 준비 필요)

## 주의사항
- Google Sheets의 시트명은 정확히 입력해야 하며, 오타가 있을 경우 시트의 데이터가 출력되지 않습니다.
- 서비스 계정에 해당 스프레드시트 접근 권한(읽기 권한 이상)이 부여되어 있어야 합니다.

## 오류 및 문의
- 실행 중 오류가 발생하거나, Google 인증/시트 접근에 문제가 있을 경우 명확한 에러 메시지가 표시됩니다.
- 추가 문의 및 피드백은 개발자에게 직접 연락해 주세요.